{"version":3,"file":"js/815.56d70734.js","mappings":"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","sources":["webpack://openchat/./src/views/JoinChatView.vue?21ea","webpack://openchat/src/views/JoinChatView.vue","webpack://openchat/./src/views/JoinChatView.vue?5c72","webpack://openchat/./src/views/JoinChatView.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"flex w-full justify-center bg-sky-500\"},[_c('div',{staticClass:\"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg my-20\"},[_c('div',{staticClass:\"flex justify-center md:justify-end -mt-16\"},[_c('img',{staticClass:\"w-20 h-20 object-cover rounded-full border-2 border-white-500\",attrs:{\"alt\":_vm.info.name,\"src\":_vm.icon}})]),_c('div',[_c('h2',{staticClass:\"text-gray-800 text-3xl font-semibold\"},[_vm._v(_vm._s(_vm.info.name))]),_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.accept),expression:\"!accept\"}],staticClass:\"mt-6 text-gray-600\",domProps:{\"innerHTML\":_vm._s(_vm.description)}}),_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.accept),expression:\"!accept\"}],staticClass:\"mt-6 text-amber-600\"},[_vm._v(\" 加入社群，即代表您同意遵守我們的 \"),_c('router-link',{staticClass:\"text-red-500\",attrs:{\"to\":\"/rule\"}},[_vm._v(\"社群守則\")]),_vm._v(\" 。 \")],1),_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.status),expression:\"status\"}],staticClass:\"mt-2 text-red-600\"},[_vm._v(_vm._s(_vm.status))]),_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.accept),expression:\"accept\"}],staticClass:\"mt-2 text-gray-600\"},[_vm._v(\" 請複製這份代碼，再貼上到OpenChat的審核答案內： \")]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.accept),expression:\"accept\"}],staticClass:\"w-full mt-2 text-gray-600 flex rounded bg-white shadow-md\"},[_c('input',{staticClass:\"w-full border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none\",attrs:{\"disabled\":!_vm.ready,\"type\":\"text\"},domProps:{\"value\":_vm.secret}}),_c('button',{staticClass:\"m-2 rounded px-4 py-2 font-semibold\",attrs:{\"disabled\":!_vm.ready},on:{\"click\":_vm.copySecret}},[_c('svg',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.ready),expression:\"!ready\"}],staticClass:\"animate-spin -ml-1 mr-3 h-5 w-5\",attrs:{\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"xmlns\":\"http://www.w3.org/2000/svg\"}},[_c('circle',{staticClass:\"opacity-25\",attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\",\"stroke\":\"currentColor\",\"stroke-width\":\"4\"}}),_c('path',{staticClass:\"opacity-75\",attrs:{\"d\":\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\",\"fill\":\"currentColor\"}})]),_c('svg',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.ready),expression:\"ready\"}],staticClass:\"h-6 w-6\",attrs:{\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"viewBox\":\"0 0 24 24\",\"xmlns\":\"http://www.w3.org/2000/svg\"}},[_c('path',{attrs:{\"d\":\"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}})])])])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.accept),expression:\"!accept\"}],staticClass:\"checkbox my-3\"},[_c('div',{attrs:{\"id\":\"captcha\",\"data-theme\":\"light\"}})]),_c('div',{staticClass:\"flex justify-end mt-4\"},[_c('button',{staticClass:\"flex items-center justify-center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full\",attrs:{\"disabled\":!_vm.ready},on:{\"click\":_vm.submit}},[_c('svg',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.ready),expression:\"!ready\"}],staticClass:\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",attrs:{\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"xmlns\":\"http://www.w3.org/2000/svg\"}},[_c('circle',{staticClass:\"opacity-25\",attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\",\"stroke\":\"currentColor\",\"stroke-width\":\"4\"}}),_c('path',{staticClass:\"opacity-75\",attrs:{\"d\":\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\",\"fill\":\"currentColor\"}})]),_vm._v(\" \"+_vm._s(_vm.state)+\" \")])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"flex w-full justify-center bg-sky-500\">\n    <div class=\"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg my-20\">\n      <div class=\"flex justify-center md:justify-end -mt-16\">\n        <img :alt=\"info.name\" :src=\"icon\" class=\"w-20 h-20 object-cover rounded-full border-2 border-white-500\">\n      </div>\n      <div>\n        <h2 class=\"text-gray-800 text-3xl font-semibold\">{{ info.name }}</h2>\n        <p v-show=\"!accept\" class=\"mt-6 text-gray-600\" v-html=\"description\"></p>\n        <p v-show=\"!accept\" class=\"mt-6 text-amber-600\">\n          加入社群，即代表您同意遵守我們的\n          <router-link class=\"text-red-500\" to=\"/rule\">社群守則</router-link>\n          。\n        </p>\n        <p v-show=\"status\" class=\"mt-2 text-red-600\">{{ status }}</p>\n        <p v-show=\"accept\" class=\"mt-2 text-gray-600\">\n          請複製這份代碼，再貼上到OpenChat的審核答案內：\n        </p>\n        <div v-show=\"accept\" class=\"w-full mt-2 text-gray-600 flex rounded bg-white shadow-md\">\n          <input :disabled=\"!ready\"\n                 :value=\"secret\"\n                 class=\"w-full border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none\"\n                 type=\"text\">\n          <button :disabled=\"!ready\" class=\"m-2 rounded px-4 py-2 font-semibold\" @click=\"copySecret\">\n            <svg v-show=\"!ready\" class=\"animate-spin -ml-1 mr-3 h-5 w-5\" fill=\"none\"\n                 viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n              <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\n              <path class=\"opacity-75\"\n                    d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                    fill=\"currentColor\"></path>\n            </svg>\n            <svg v-show=\"ready\" class=\"h-6 w-6\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"\n                 viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path\n                  d=\"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2\"\n                  stroke-linecap=\"round\"\n                  stroke-linejoin=\"round\"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n      <div v-show=\"!accept\" class=\"checkbox my-3\">\n        <div id=\"captcha\" data-theme=\"light\"></div>\n      </div>\n      <div class=\"flex justify-end mt-4\">\n        <button\n            :disabled=\"!ready\"\n            class=\"flex items-center justify-center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full\"\n            @click=\"submit\"\n        >\n          <svg v-show=\"!ready\" class=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" fill=\"none\"\n               viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n            <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\n            <path class=\"opacity-75\"\n                  d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                  fill=\"currentColor\"></path>\n          </svg>\n          {{ state }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport data from \"@/assets/hub.json\";\n\nexport default {\n  name: \"JoinChatView\",\n  props: {\n    code: {\n      type: String,\n      required: true\n    }\n  },\n  data: () => ({\n    info: {\n      name: null,\n      description: null,\n      url: null\n    },\n    captcha: null,\n    secret: null,\n    status: null,\n    accept: false,\n    ready: true,\n    turnstileScript: null,\n  }),\n  computed: {\n    icon() {\n      if (!this.code) return null;\n      return `${process.env.BASE_URL}static/images/chats/${this.code}.jpg`;\n    },\n    description() {\n      return this.info.description.replaceAll(\"\\n\", \"<br />\")\n    },\n    state() {\n      return !this.accept ?\n          \"加入社群\"\n          : this.ready\n              ? \"前往OpenChat界面貼上代碼\"\n              : \"載入中...\"\n    }\n  },\n  methods: {\n    copySecret() {\n      if (!navigator.clipboard) {\n        this.status = '您的瀏覽器不支援複製功能'\n        return\n      }\n      navigator.clipboard\n          .writeText(this.secret)\n          .then(() => this.status = '已複製代碼')\n          .catch(() => this.status = '無法複製代碼')\n    },\n    async submit() {\n      if (!this.accept) {\n        if (!this.captcha) {\n          this.status = '尚未完成系統驗證';\n          return;\n        }\n\n        this.accept = true;\n        this.ready = false;\n        this.status = \"\";\n        const form = new URLSearchParams();\n        form.set('slug', this.code);\n        form.set('captcha', this.captcha);\n        try {\n          const xhr = await this.$axios.post(\"applications\", form)\n          this.ready = true;\n          this.secret = xhr.data.code;\n        } catch (e) {\n          if (e?.response?.data?.code) {\n            this.secret = e?.response?.data?.code;\n          } else {\n            this.status = '授權伺服器發生嚴重錯誤';\n          }\n        } finally {\n          this.ready = true;\n        }\n      } else {\n        location.href = this.info.url;\n      }\n    }\n  },\n  mounted() {\n    document.head.appendChild(this.turnstileScript);\n  },\n  beforeDestroy() {\n    document.head.removeChild(this.turnstileScript);\n  },\n  created() {\n    const turnstileScriptUrl = \"https://challenges.cloudflare.com/turnstile/v0/api.js?onload=loadTurnstile\";\n    this.turnstileScript = document.createElement(\"script\");\n    this.turnstileScript.setAttribute(\"src\", turnstileScriptUrl);\n    window.loadTurnstile = () => {\n      window.turnstile.render(\"#captcha\", {\n        sitekey: process.env.VUE_APP_TURNSTILE_SITE_KEY,\n        callback: (token) => {\n          this.captcha = token;\n        },\n      });\n    };\n    if (this.code in data) {\n      this.info = data[this.code];\n    } else {\n      this.$router.replace({name: \"join\"});\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./JoinChatView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./JoinChatView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./JoinChatView.vue?vue&type=template&id=066550da&\"\nimport script from \"./JoinChatView.vue?vue&type=script&lang=js&\"\nexport * from \"./JoinChatView.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","info","name","icon","_v","_s","directives","rawName","value","accept","expression","domProps","description","status","ready","secret","on","copySecret","submit","state","staticRenderFns","props","code","type","String","required","data","url","captcha","turnstileScript","computed","replaceAll","methods","navigator","clipboard","writeText","then","catch","async","location","href","form","URLSearchParams","set","xhr","$axios","post","e","response","mounted","document","head","appendChild","beforeDestroy","removeChild","created","turnstileScriptUrl","createElement","setAttribute","window","loadTurnstile","turnstile","sitekey","callback","token","$router","replace","component"],"sourceRoot":""}